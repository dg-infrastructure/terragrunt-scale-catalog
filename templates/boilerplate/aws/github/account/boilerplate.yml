dependencies:
  - name: aws-account
    template-url: ../../../.dependencies/aws/account
    output-folder: .

variables:
  - name: AccountName
    type: string
    description: The name of the first account you are bootstrapping Pipelines in.
    order: 1

  - name: AWSAccountID
    type: string
    description: The ID of the AWS account you are bootstrapping Pipelines in.
    order: 2

  - name: GitHubOrgName
    type: string
    description: The name of the GitHub organization you are bootstrapping Pipelines in.
    order: 3

  - name: GitHubRepoName
    type: string
    description: The name of the GitHub repository you are bootstrapping Pipelines in.
    order: 4

  - name: TerragruntScaleCatalogRef
    type: string
    description: The Git reference of the Terragrunt catalog to use.
    default: "v1.0.0"
    order: 5

  - name: OIDCResourcePrefix
    type: string
    description: The prefix for the OIDC resources you using to bootstrap Pipelines.
    default: "pipelines"
    order: 6

  - name: Issuer
    type: string
    description: The issuer URL for the OIDC provider (is computed dynamically from the SCM provider if not specified).
    default: ""
    order: 7

  - name: OIDCProviderImportExisting
    type: bool
    description: Whether to import an existing OIDC provider.
    default: false
    order: 8

  - name: OIDCProviderImportARN
    type: string
    description: ARN of an existing OIDC provider to import.
    default: "{{if .OIDCProviderImportExisting}}arn:aws:iam::{{.AWSAccountID}}:oidc-provider/{{if .Issuer}}{{trimPrefix .Issuer \"https://\"}}{{else}}token.actions.githubusercontent.com{{end}}{{end}}"
    order: 9

  - name: PlanIAMRoleImportExisting
    type: bool
    description: Whether to import an existing plan IAM role.
    default: false
    order: 10

  - name: PlanIamPolicyImportExisting
    type: bool
    description: Whether to import an existing plan IAM policy.
    default: false
    order: 11

  - name: PlanIAMRolePolicyAttachmentImportExisting
    type: bool
    description: Whether to import an existing plan IAM role policy attachment.
    default: false
    order: 12

  - name: PlanIAMPolicyImportARN
    type: string
    description: ARN of an existing plan IAM policy to import.
    # Format is arn:aws:iam::account-id:policy/policy-name
    default: "{{if .PlanIAMRoleImportExisting}}arn:aws:iam::{{.AWSAccountID}}:policy/{{.OIDCResourcePrefix}}-plan{{end}}"
    order: 13

  - name: PlanIAMRolePolicyAttachmentImportARN
    type: string
    description: ARN of an existing plan IAM role policy attachment to import.
    # Format is role-name/policy-arn
    default: "{{if .PlanIAMRolePolicyAttachmentImportExisting}}{{.OIDCResourcePrefix}}-plan/arn:aws:iam::{{.AWSAccountID}}:policy/{{.OIDCResourcePrefix}}-plan{{end}}"
    order: 14

  - name: ApplyIAMRoleImportExisting
    type: bool
    description: Whether to import an existing apply IAM role.
    default: false
    order: 15

  - name: ApplyIamPolicyImportExisting
    type: bool
    description: Whether to import an existing apply IAM policy.
    default: false
    order: 16

  - name: ApplyIAMRolePolicyAttachmentImportExisting
    type: bool
    description: Whether to import an existing apply IAM role policy attachment.
    default: false
    order: 17

  - name: ApplyIAMPolicyImportARN
    type: string
    description: ARN of an existing apply IAM policy to import.
    # Format is arn:aws:iam::account-id:policy/policy-name
    default: "{{if .ApplyIAMRoleImportExisting}}arn:aws:iam::{{.AWSAccountID}}:policy/{{.OIDCResourcePrefix}}-apply{{end}}"
    order: 18

  - name: ApplyIAMRolePolicyAttachmentImportARN
    type: string
    description: ARN of an existing apply IAM role policy attachment to import.
    # Format is role-name/policy-arn
    default: "{{if .ApplyIAMRolePolicyAttachmentImportExisting}}{{.OIDCResourcePrefix}}-apply/arn:aws:iam::{{.AWSAccountID}}:policy/{{.OIDCResourcePrefix}}-apply{{end}}"
    order: 19
